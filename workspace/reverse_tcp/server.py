import socket

HOST = '192.168.1.18'
PORT = 8080
DELIM = '\0'

def get_data(sock):
    while True:
        data = sock.recv(1024)
        if DELIM in data:
            break
        else:
            yield data
    yield data[:-len(DELIM)]

def main():
    sock = socket.socket()
    sock.bind((HOST, PORT))

    sock.listen(1)
    conn, addr = sock.accept()

    print 'Got connection from %s' % (addr,)
    while True:
        try:
            cmd = raw_input('> ')

            if cmd:
                conn.send(cmd + DELIM)
                print ''.join(get_data(conn))
        except KeyboardInterrupt:
            conn.send('shutdown' + DELIM)
            conn.close()
            sock.close()
            break

if __name__ == '__main__':
    main()
